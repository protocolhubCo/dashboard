<!DOCTYPE html>
<html>
  <head>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  </head>
  <body>
    <canvas id="stackedBarChart" style="width: 100%; height: 400px;"></canvas>
    <script>
      const ctx = document.getElementById('stackedBarChart').getContext('2d');

      // Data structure for stacked bars
      const data = {
        labels: ['User', 'Friend1', 'Friend2'], // Each column's label
        datasets: [
          {
            label: 'Completed',
            data: [24, 16, 32], // Completed percentages relative to 100% protocols
            backgroundColor: 'rgba(75, 192, 192, 0.8)', // Teal color
          },
          {
            label: 'Remaining (Chosen)',
            data: [36, 24, 48], // Remaining chosen percentages relative to 100%
            backgroundColor: 'rgba(200, 200, 200, 0.8)', // Light grey color
            borderRadius: {
              topLeft: 10, // Round the top-left corner
              topRight: 10, // Round the top-right corner
              bottomLeft: 0,
              bottomRight: 0, // Keep bottom corners sharp
            },
          },
        ],
      };

      // Configuration options for stacked bar chart
      const options = {
        plugins: {
          title: {
            display: true,
            text: 'Progress by User and Friends (in %)',
          },
          legend: {
            position: 'top',
          },
        },
        responsive: true,
        scales: {
          x: {
            stacked: true, // Stack the bars
            title: {
              display: true,
              text: 'Participants',
            },
          },
          y: {
            stacked: true, // Stack the bars
            beginAtZero: true,
            max: 100, // Set maximum to 100% for percentage scale
            ticks: {
              callback: function (value) {
                return value + '%'; // Display values as percentages
              },
            },
            title: {
              display: true,
              text: 'Percentage of Protocols',
            },
          },
        },
      };

      // Render the chart
      new Chart(ctx, {
        type: 'bar',
        data: data,
        options: options,
      });
    </script>
  </body>
</html>
